<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ã–dev Takip Sistemi</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#3498db">
<style>
body{font-family:Arial,sans-serif;background:#f4f6f8;margin:0;padding:10px}
h1,h2{text-align:center}
.section{background:#fff;padding:15px;margin-bottom:15px;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,.1)}
input,select,button{width:100%;padding:14px;margin-top:6px;margin-bottom:12px;font-size:1rem}
button{border:none;border-radius:10px;background:#3498db;color:#fff}
button.secondary{background:#7f8c8d}
button.danger{background:#e74c3c}
.ogrenci{background:#ecf0f1;padding:10px;border-radius:10px;margin-bottom:8px}
.row{display:flex;gap:8px;margin-top:8px}
.row button{flex:1}
.gecmis{font-size:0.9rem;margin-top:6px}
</style>
</head>
<body>

<h1 id="okulAdi"></h1>
<h2 id="ogretmenAdi"></h2>

<div class="section" id="ayarlarSection">
<h2>ğŸ“Œ Ayarlar</h2>
<input id="okulInput" placeholder="Okul AdÄ±">
<input id="ogretmenInput" placeholder="Ã–ÄŸretmen AdÄ±">
<input type="password" id="pinInput" placeholder="PIN Kodu">
<button id="kaydetAyar">Kaydet</button>
</div>

<div class="section" id="ogrenciSection" style="display:none">
<h2>ğŸ‘¨â€ğŸ“ Ã–ÄŸrenci YÃ¶netimi</h2>
<input id="ad" placeholder="Ad Soyad">
<input id="no" placeholder="Numara">
<input id="sinif" placeholder="SÄ±nÄ±f">
<button id="kaydetBtn" type="button">Kaydet</button>
<button id="iptalBtn" type="button" class="secondary">Ä°ptal</button>
<hr>
<input id="arama" placeholder="Ã–ÄŸrenci adÄ± veya no ile ara">
<div id="aramaSonuc"></div>
</div>

<div class="section" id="odevSection" style="display:none">
<h2>ğŸ“‹ Ã–dev Kontrol</h2>
<input type="date" id="odevTarih">
<select id="odevSinif"></select>
<select id="odevOgrenciSec" size="6"></select>
<div id="odevIslem"></div>
</div>

<div class="section" id="pdfSection" style="display:none">
<h2>ğŸ“Š PDF Rapor</h2>
<label>GÃ¼nlÃ¼k Rapor</label>
<input type="date" id="gunlukPdfTarih">
<button onclick="gunlukPdf()">PDF OluÅŸtur</button>
<hr>
<label>AylÄ±k Rapor</label>
<input type="month" id="raporAy">
<button onclick="aylikPdf()">PDF OluÅŸtur</button>
</div>

<script>
let ogrenciler=JSON.parse(localStorage.getItem('ogrenciler'))||[];
let odevler=JSON.parse(localStorage.getItem('odevler'))||[];
let okul=localStorage.getItem('okulAdi')||'';
let ogretmen=localStorage.getItem('ogretmenAdi')||'';
let pinKayit=localStorage.getItem('pin')||'';
let seciliNo=null;

const ayarlarSection=document.getElementById('ayarlarSection');
const ogrenciSection=document.getElementById('ogrenciSection');
const odevSection=document.getElementById('odevSection');
const pdfSection=document.getElementById('pdfSection');
const okulInput=document.getElementById('okulInput');
const ogretmenInput=document.getElementById('ogretmenInput');
const pinInput=document.getElementById('pinInput');
const okulAdiH=document.getElementById('okulAdi');
const ogretmenAdiH=document.getElementById('ogretmenAdi');

function girisKontrol(){
 if(!okul||!ogretmen||!pinKayit){
  ayarlarSection.style.display='block';
 } else {
  let giris=prompt('PIN kodu girin:');
  if(giris!==pinKayit){alert('YanlÄ±ÅŸ PIN'); return;}
  ayarlarSection.style.display='none';
  ogrenciSection.style.display='block'; odevSection.style.display='block'; pdfSection.style.display='block';
  okulAdiH.textContent=okul; ogretmenAdiH.textContent=ogretmen;
 }
}

document.getElementById('kaydetAyar').onclick=()=>{
 okul=okulInput.value.trim();
 ogretmen=ogretmenInput.value.trim();
 pinKayit=pinInput.value.trim();
 if(!okul||!ogretmen||!pinKayit){alert('TÃ¼m alanlarÄ± doldurun'); return;}
 localStorage.setItem('okulAdi',okul);
 localStorage.setItem('ogretmenAdi',ogretmen);
 localStorage.setItem('pin',pinKayit);
 ayarlarSection.style.display='none';
 ogrenciSection.style.display='block'; odevSection.style.display='block'; pdfSection.style.display='block';
 okulAdiH.textContent=okul; ogretmenAdiH.textContent=ogretmen;
};

// Ã–ÄŸrenci iÅŸlemleri, arama, silme, gÃ¼ncelleme
// ... Ã¶nceki kodun kaydet, arama, sil, duzenle fonksiyonlarÄ± buraya gelecek

// Ã–dev kontrolÃ¼nde yapmadÄ±/gelmedi seÃ§imi
function odevSec(no){
 const div=document.getElementById('odevIslem');
 div.innerHTML=`<button onclick="odevKaydet('${no}','yapti')">âœ… YaptÄ±</button>
 <button class='danger' onclick="odevKaydet('${no}','yapmadi')">âŒ YapmadÄ±</button>
 <button onclick="odevKaydet('${no}','gelmedi')">ğŸš« Gelmedi</button>`;
}

function odevKaydet(no,durum){
 const tarih=document.getElementById('odevTarih').value;
 const i=odevler.findIndex(o=>o.no===no&&o.tarih===tarih);
 if(i>-1) odevler[i].durum=durum; else odevler.push({no,tarih,durum});
 localStorage.setItem('odevler',JSON.stringify(odevler));
 alert('Kaydedildi');
}

// PDF oluÅŸturma
function gunlukPdf(){
 const tarih=document.getElementById('gunlukPdfTarih').value;
 if(!tarih){alert('Tarih seÃ§in'); return;}
 const { jsPDF } = window.jspdf;
 ogrenciler.forEach(sinifOgrenciler=>{
  const doc=new jsPDF();
  let y=20;
  const sinifAdi=sinifOgrenciler.sinif;
  doc.text(`${sinifAdi} - GÃ¼nlÃ¼k Ã–dev Raporu`,10,10);
  doc.text(`Okul: ${okul}  Ã–ÄŸretmen: ${ogretmen}`,10,15);
  doc.text('Numara | Ã–ÄŸrenci AdÄ± | Durum',10,y); y+=8;
  odevler.filter(o=>o.tarih===tarih).forEach(o=>{
   const ogr=ogrenciler.find(x=>x.no===o.no);
   if(!ogr||ogr.sinif!==sinifAdi) return;
   doc.text(`${ogr.no} | ${ogr.ad} | ${o.durum}`,10,y); y+=8;
  });
  doc.save(`gunluk_${sinifAdi}_${tarih}.pdf`);
 });
}

function aylikPdf(){
 const ay=document.getElementById('raporAy').value;
 if(!ay){alert('Ay seÃ§in'); return;}
 const { jsPDF } = window.jspdf;
 const sinifSet=[...new Set(ogrenciler.map(o=>o.sinif))];
 sinifSet.forEach(sinifAdi=>{
  const doc=new jsPDF(); let y=20;
  doc.text(`${sinifAdi} - AylÄ±k Ã–dev Raporu`,10,10);
  doc.text(`Okul: ${okul}  Ã–ÄŸretmen: ${ogretmen}`,10,15);
  const odevTarihleri=[...new Set(odevler.filter(o=>o.tarih.startsWith(ay)).map(o=>o.tarih))];
  odevTarihleri.forEach(tarih=>{
   doc.text(tarih,10,y); y+=8;
   odevler.filter(o=>o.tarih===tarih).forEach(o=>{
    const ogr=ogrenciler.find(x=>x.no===o.no);
    if(!ogr||ogr.sinif!==sinifAdi) return;
    doc.text(`${ogr.no} | ${ogr.ad} | ${o.durum}`,10,y); y+=8;
   });
   y+=4;
  });
  doc.save(`aylik_${sinifAdi}_${ay}.pdf`);
 });
}

girisKontrol();
</script>
</body>
</html>