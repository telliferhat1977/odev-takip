<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telefon Uyumlu Ã–dev Takip</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#3498db">
<style>
body{font-family:Arial,sans-serif;background:#f4f6f8;margin:0;padding:10px}
h1,h2{text-align:center}
.section{background:#fff;padding:15px;margin-bottom:15px;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,.1)}
input,select,button{width:100%;padding:14px;margin-top:6px;margin-bottom:12px;font-size:1rem}
button{border:none;border-radius:10px;background:#3498db;color:#fff}
button.secondary{background:#7f8c8d}
button.danger{background:#e74c3c}
.ogrenci{background:#ecf0f1;padding:10px;border-radius:10px;margin-bottom:8px}
.row{display:flex;gap:8px;margin-top:8px}
.row button{flex:1}
</style>
</head>
<body>

<h1>ğŸ“˜ Ã–dev Takip Sistemi</h1>
<p id="baslik" style="text-align:center;font-weight:bold"></p>

<div class="section">
<h2>ğŸ‘¨â€ğŸ“ Ã–ÄŸrenci Ekle / GÃ¼ncelle</h2>
<input id="ad" placeholder="Ad Soyad">
<input id="no" placeholder="Numara">
<input id="sinif" placeholder="SÄ±nÄ±f">
<button onclick="kaydet()" id="kaydetBtn">Kaydet</button>
<button class="secondary" onclick="iptal()">Ä°ptal</button>
<div id="liste"></div>
</div>

<div class="section">
<h2>ğŸ“‹ Ã–dev Kontrol</h2>
<select id="odevSinif" onchange="odevSinifDegisti()"></select>
<div id="odevOgrenciListesi"></div>
</div>

<div class="section">
<h2>ğŸ« Okul / Ã–ÄŸretmen</h2>
<input id="okulAdi" placeholder="Okul AdÄ±">
<input id="ogretmenAdi" placeholder="Ã–ÄŸretmen AdÄ±">
<button onclick="bilgiKaydet()">Kaydet</button>
</div>

<div class="section">
<h2>ğŸ“Š AylÄ±k PDF Rapor</h2>
<input type="month" id="ay">
<button onclick="pdfRapor()">PDF OluÅŸtur</button>
</div>

<div class="section">
<h2>â˜ï¸ Yedekleme</h2>
<button onclick="yedekAl()">iCloud / Drive Yedek</button>
<button class="secondary" onclick="yedekYukle()">Yedekten YÃ¼kle</button>
</div>

<script>
let ogrenciler = JSON.parse(localStorage.getItem('ogrenciler'))||[];
let odevler = JSON.parse(localStorage.getItem('odevler'))||[];
let okulBilgi = JSON.parse(localStorage.getItem('okulBilgi'))||{};
let seciliNo = null;

const adInp=ad,noInp=no,sinifInp=sinif;

function kaydet(){
 const ad=adInp.value.trim(), no=noInp.value.trim(), sinif=sinifInp.value.trim();
 if(!ad||!no||!sinif){alert('TÃ¼m alanlarÄ± doldurun');return;}
 if(seciliNo){
   if(!confirm('Ã–ÄŸrenci gÃ¼ncellensin mi?')) return;
   const o=ogrenciler.find(x=>x.no===seciliNo);
   o.ad=ad; o.no=no; o.sinif=sinif;
   seciliNo=null; kaydetBtn.textContent='Kaydet';
 } else {
   if(ogrenciler.some(o=>o.no===no)){alert('Bu numara var');return;}
   ogrenciler.push({ad,no,sinif});
 }
 localStorage.setItem('ogrenciler',JSON.stringify(ogrenciler));
 temizle(); listele(); odevSiniflariDoldur();
}

function duzenle(no){
 const o=ogrenciler.find(x=>x.no===no);
 adInp.value=o.ad; noInp.value=o.no; sinifInp.value=o.sinif;
 seciliNo=no; kaydetBtn.textContent='GÃ¼ncelle';
}

function sil(no){
 const o=ogrenciler.find(x=>x.no===no);
 if(!confirm(o.ad+' silinsin mi?')) return;
 ogrenciler=ogrenciler.filter(x=>x.no!==no);
 odevler=odevler.filter(x=>x.no!==no);
 localStorage.setItem('ogrenciler',JSON.stringify(ogrenciler));
 localStorage.setItem('odevler',JSON.stringify(odevler));
 listele(); odevSiniflariDoldur();
}

function listele(){
 liste.innerHTML='';
 ogrenciler.forEach(o=>{
  const d=document.createElement('div');
  d.className='ogrenci';
  d.innerHTML=`<b>${o.ad}</b><br>No:${o.no} | ${o.sinif}
  <div class='row'>
  <button onclick="duzenle('${o.no}')">âœï¸</button>
  <button class='danger' onclick="sil('${o.no}')">ğŸ—‘ï¸</button>
  </div>`;
  liste.appendChild(d);
 });
}

function temizle(){adInp.value='';noInp.value='';sinifInp.value='';}
function iptal(){temizle();seciliNo=null;kaydetBtn.textContent='Kaydet';}

function odevSiniflariDoldur(){
 const s=document.getElementById('odevSinif');
 s.innerHTML='<option value="">SÄ±nÄ±f SeÃ§</option>';
 [...new Set(ogrenciler.map(o=>o.sinif)))].forEach(x=>{
  s.innerHTML+=`<option>${x}</option>`;
 });
}

function odevSinifDegisti(){
 const sinif=document.getElementById('odevSinif').value;
 const alan=document.getElementById('odevOgrenciListesi');
 alan.innerHTML='';
 const tarih=new Date().toISOString().split('T')[0];
 ogrenciler.filter(o=>o.sinif===sinif).forEach(o=>{
  const d=document.createElement('div');
  d.className='ogrenci';
  const kayit=odevler.find(x=>x.no===o.no && x.tarih===tarih);
  d.innerHTML=`<b>${o.ad}</b>
  <div class='row'>
   <button onclick="odevKaydet('${o.no}',true)">âœ…</button>
   <button class='danger' onclick="odevKaydet('${o.no}',false)">âŒ</button>
  </div>`;
  alan.appendChild(d);
 });
}

function odevKaydet(no,yapti){
 const tarih=new Date().toISOString().split('T')[0];
 const i=odevler.findIndex(o=>o.no===no && o.tarih===tarih);
 if(i>-1) odevler[i].yapti=yapti;
 else odevler.push({no,tarih,yapti});
 localStorage.setItem('odevler',JSON.stringify(odevler));
}

function bilgiKaydet(){
 okulBilgi={okul:okulAdi.value,ogretmen:ogretmenAdi.value};
 localStorage.setItem('okulBilgi',JSON.stringify(okulBilgi));
 baslik.textContent=`${okulBilgi.okul||''} ${okulBilgi.ogretmen||''}`;
}

function pdfRapor(){
 const ayVal=ay.value; if(!ayVal){alert('Ay seÃ§');return;}
 let html=`<h2>${okulBilgi.okul||''}</h2><h3>${okulBilgi.ogretmen||''}</h3><table border=1 width=100%><tr><th>SÄ±nÄ±f</th><th>Ad</th><th>No</th><th>Tarih</th><th>Durum</th></tr>`;
 odevler.filter(o=>o.tarih.startsWith(ayVal)).forEach(o=>{
  const ogr=ogrenciler.find(x=>x.no===o.no); if(!ogr) return;
  html+=`<tr><td>${ogr.sinif}</td><td>${ogr.ad}</td><td>${ogr.no}</td><td>${o.tarih}</td><td>${o.yapti?'YaptÄ±':'YapmadÄ±'}</td></tr>`;
 });
 html+='</table>';
 const w=window.open('','_blank'); w.document.write(html); w.print();
}

function yedekAl(){
 const blob=new Blob([JSON.stringify({ogrenciler,odevler,okulBilgi})],{type:'application/json'});
 const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='odev_yedek.json'; a.click();
}

function yedekYukle(){
 const i=document.createElement('input'); i.type='file'; i.accept='.json';
 i.onchange=e=>{const r=new FileReader(); r.onload=()=>{
 const d=JSON.parse(r.result);
 ogrenciler=d.ogrenciler||[]; odevler=d.odevler||[]; okulBilgi=d.okulBilgi||{};
 localStorage.setItem('ogrenciler',JSON.stringify(ogrenciler));
 localStorage.setItem('odevler',JSON.stringify(odevler));
 localStorage.setItem('okulBilgi',JSON.stringify(okulBilgi));
 listele(); odevSiniflariDoldur(); baslik.textContent=`${okulBilgi.okul||''} ${okulBilgi.ogretmen||''}`;
 }; r.readAsText(e.target.files[0]);}; i.click();
}

listele(); odevSiniflariDoldur(); baslik.textContent=`${okulBilgi.okul||''} ${okulBilgi.ogretmen||''}`;
</script>
</body>
</html>
