<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>SinemaTV PRO</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
:root{--red:#E50914;--black:#080808}
body{background:var(--black);color:#fff;margin:0;padding:10px;font-family:sans-serif}
.nav-item{cursor:pointer;border-radius:12px;transition:.15s}
.nav-item:active{transform:scale(.95)}
.full-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.97);overflow-y:auto}
.show{display:flex}
</style>
</head>

<body onload="loadShowcase()">

<header class="text-center mb-4">
<h1 class="text-3xl font-black italic text-red-600">SinemaTV PRO</h1>
<div class="flex gap-2 mt-3">
<input id="searchInput" placeholder="Film / Dizi / Oyuncu"
 class="flex-1 p-3 bg-[#1a1a1a] rounded-xl nav-item">
<button onclick="searchContent()"
 class="px-6 bg-red-600 rounded-xl font-bold nav-item">ARA</button>
</div>
</header>

<div id="home" class="grid grid-cols-3 gap-4"></div>

<!-- DETAIL -->
<div id="detailPage" class="full-modal flex-col items-center p-6">
<div class="flex w-full justify-between mb-3">
<button onclick="goBack()" class="nav-item px-4 py-2 bg-white/10 rounded-full">‚Üê Geri</button>
<button onclick="goHome()" class="nav-item px-4 py-2 bg-red-600 rounded-full">‚åÇ Ana</button>
</div>
<img id="detailPoster" class="max-h-[250px] rounded-xl mb-4">
<h2 id="detailTitle" class="text-xl font-black mb-3"></h2>
<div id="castList" class="flex flex-wrap gap-2 mb-6"></div>
<button onclick="openSources()" class="bg-red-600 px-8 py-4 rounded-xl font-black nav-item">‚ñ∂ ƒ∞ZLE</button>
</div>

<!-- ACTOR -->
<div id="actorPage" class="full-modal flex-col items-center p-6">
<div class="flex w-full justify-between mb-3">
<button onclick="goBack()" class="nav-item px-4 py-2 bg-white/10 rounded-full">‚Üê Geri</button>
<button onclick="goHome()" class="nav-item px-4 py-2 bg-red-600 rounded-full">‚åÇ Ana</button>
</div>
<img id="actorPhoto" class="w-32 h-32 rounded-full mb-3 object-cover">
<h2 id="actorName" class="text-xl font-black mb-2"></h2>
<p id="actorBio" class="text-xs text-gray-400 text-center mb-4"></p>
<div id="actorFilmography" class="grid grid-cols-3 gap-4"></div>
</div>

<!-- PLAYER -->
<div id="player" class="full-modal flex-col">
<button onclick="closePlayer()" class="m-3 bg-white/10 px-6 py-2 rounded-full nav-item">‚Üê Kapat</button>
<iframe id="playerFrame" class="flex-1 w-full" allowfullscreen></iframe>
</div>

<script>
const TMDB="847629da5649502fa6655f73b15a5c8e";
let currentView="home";
let historyStack=[];
let currentId,currentType,imdbId;

/* ---------------- NAVIGATION CORE ---------------- */
function showView(id){
document.querySelectorAll(".full-modal").forEach(v=>v.classList.remove("show"));
if(id==="home") home.style.display="grid";
else home.style.display="none";
document.getElementById(id)?.classList.add("show");
currentView=id;
}

function navigate(to){
if(currentView===to) return;

/* üîë KRƒ∞Tƒ∞K D√úZELTME */
if(currentView==="actorPage" && to==="detailPage"){
  showView(to);
  return;
}

historyStack.push(currentView);
showView(to);
}

function goBack(){
if(!historyStack.length) return goHome();
const prev=historyStack.pop();
showView(prev);
}

function goHome(){
historyStack=[];
showView("home");
}

/* ---------------- DATA ---------------- */
async function loadShowcase(){
const r=await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB}&language=tr`);
displayItems((await r.json()).results);
}

async function searchContent(){
const q=searchInput.value.trim();
if(!q) return loadShowcase();
const r=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB}&query=${q}&language=tr`);
displayItems((await r.json()).results);
}

function displayItems(items){
home.innerHTML="";
items.forEach(i=>{
if(!i.poster_path) return;
const type=i.media_type==="tv"?"tv":"movie";
const b=document.createElement("button");
b.className="nav-item";
b.innerHTML=`<img src="https://image.tmdb.org/t/p/w300${i.poster_path}" class="rounded-lg">
<div class="text-xs font-bold truncate mt-1">${i.title||i.name}</div>`;
b.onclick=()=>openDetails(i.id,type);
home.appendChild(b);
});
}

/* ---------------- DETAIL ---------------- */
async function openDetails(id,type){
currentId=id;currentType=type;
const r=await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB}&language=tr&append_to_response=credits,external_ids`);
const d=await r.json();
imdbId=d.external_ids.imdb_id;
detailPoster.src=`https://image.tmdb.org/t/p/w500${d.poster_path}`;
detailTitle.innerText=d.title||d.name;
castList.innerHTML="";
d.credits.cast.slice(0,8).forEach(a=>{
const c=document.createElement("button");
c.className="nav-item bg-[#222] px-3 py-1 text-xs rounded-full";
c.innerText=a.name;
c.onclick=()=>openActor(a.id);
castList.appendChild(c);
});
navigate("detailPage");
}

/* ---------------- ACTOR ---------------- */
async function openActor(id){
const r=await fetch(`https://api.themoviedb.org/3/person/${id}?api_key=${TMDB}&language=tr&append_to_response=combined_credits`);
const d=await r.json();
actorName.innerText=d.name;
actorBio.innerText=d.biography||"Biyografi yok";
actorPhoto.src=d.profile_path?`https://image.tmdb.org/t/p/w300${d.profile_path}`:"";
actorFilmography.innerHTML="";
d.combined_credits.cast.filter(x=>x.poster_path).forEach(i=>{
const type=i.media_type==="tv"?"tv":"movie";
const b=document.createElement("button");
b.className="nav-item";
b.innerHTML=`<img src="https://image.tmdb.org/t/p/w300${i.poster_path}" class="rounded-lg">
<div class="text-xs truncate">${i.title||i.name}</div>`;
b.onclick=()=>openDetails(i.id,type);
actorFilmography.appendChild(b);
});
navigate("actorPage");
}

/* ---------------- PLAYER ---------------- */
function openSources(){
playerFrame.src=currentType==="movie"
?`https://vidsrc.me/embed/movie?tmdb=${currentId}`
:`https://vidsrc.me/embed/tv?tmdb=${currentId}`;
navigate("player");
}
function closePlayer(){
playerFrame.src="";
goBack();
}
</script>
</body>
</html>