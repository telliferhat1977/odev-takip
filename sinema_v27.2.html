<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SinemaTV Pro v27.6 - Mega P2P Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --n-red: #E50914; --n-black: #080808; }
        body { background-color: var(--n-black); color: white; font-family: sans-serif; margin: 0; padding: 10px; overflow-x: hidden; }
        .nav-item { transition: all 0.2s; cursor: pointer; border: 2px solid transparent; outline: none; border-radius: 12px; overflow: hidden; }
        .nav-item:focus { border-color: white !important; background-color: var(--n-red) !important; transform: scale(1.05); z-index: 50; }
        .poster-info { font-size: 8px; color: #888; text-transform: uppercase; font-weight: bold; margin-top: 3px; letter-spacing: 0.5px; }
        .poster-title { font-size: 10px; font-weight: 800; color: #fff; margin-top: 5px; line-height: 1.2; }
        .full-modal { display: none !important; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 1000; padding: 20px; overflow-y: auto; }
        .show-modal { display: flex !important; flex-direction: column; align-items: center; }
        .show-block { display: block !important; }
        .video-layer { display: none; position: fixed; inset: 0; background: black; z-index: 2000; flex-direction: column; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body onload="loadShowcase()">

    <div id="mainUI">
        <header class="flex flex-col items-center mb-5 px-2 text-center">
            <h1 class="text-4xl font-black text-[#E50914] italic mb-4">Sinema<span class="text-white">TV PRO</span></h1>
            <div class="flex w-full gap-2 mb-4">
                <input type="text" id="searchInput" placeholder="Film, Dizi veya Oyuncu Ara..." class="nav-item bg-[#1a1a1a] p-4 flex-1 rounded-xl outline-none text-sm border-none">
                <button onclick="searchContent()" class="nav-item bg-[#E50914] px-6 py-4 rounded-xl font-bold text-xs uppercase">ARA</button>
            </div>
            <div id="sectionTitle" class="w-full text-left text-[10px] font-bold text-gray-600 uppercase tracking-widest px-1">Vizyondaki Filmler (2026-2025)</div>
        </header>
        <div id="results" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4 px-1"></div>
    </div>

    <div id="detailPage" class="full-modal">
        <div class="w-full max-w-4xl text-center">
            <button onclick="closeDetail()" class="nav-item mb-4 bg-white/10 px-10 py-3 rounded-full font-bold text-xs uppercase">‚Üê ANA SAYFA</button>
            <div class="flex flex-col items-center">
                <img id="detailPoster" src="" class="mb-5 max-h-[250px] rounded-2xl border-2 border-white/5 shadow-2xl">
                <h2 id="detailTitle" class="text-3xl font-black mb-1 leading-tight"></h2>
                <div class="flex gap-4 mb-4 text-[12px] font-bold text-yellow-500">
                    <span id="detailRating"></span> ‚Ä¢ <span id="detailYear"></span>
                </div>
                <div id="castList" class="flex flex-wrap justify-center gap-2 mb-8 px-4"></div>
                <button onclick="startPlayback()" class="nav-item bg-[#E50914] w-full max-w-md py-6 rounded-2xl font-black text-lg uppercase shadow-2xl">‚ñ∂ YAYINLARI Lƒ∞STELE</button>
            </div>
        </div>
    </div>

    <div id="selectionModal" class="full-modal">
        <div class="bg-[#0f0f0f] w-full max-w-2xl p-6 rounded-3xl border border-white/10 shadow-2xl">
            <h2 id="modalTitle" class="text-xl font-black mb-5 text-red-600 uppercase text-center italic tracking-widest">KAYNAK SE√áƒ∞N</h2>
            <div id="modalList" class="space-y-3 max-h-[65vh] overflow-y-auto pr-2"></div>
            <button onclick="closeModal('selectionModal')" class="nav-item mt-6 w-full p-5 bg-gray-900 rounded-xl font-bold uppercase text-xs tracking-widest">KAPAT / ƒ∞PTAL</button>
        </div>
    </div>

    <div id="videoLayer" class="video-layer">
        <div class="p-4 bg-black flex justify-between items-center border-b border-white/5">
            <button onclick="closePlayer()" class="nav-item bg-white/10 px-8 py-2 rounded-full font-bold text-[10px] uppercase">‚Üê GERƒ∞ D√ñN</button>
            <div class="text-[10px] text-gray-500 font-bold uppercase tracking-tighter italic">Ultra Stream Engine Active</div>
        </div>
        <iframe id="playerFrame" src="" class="flex-1 w-full border-none" allowfullscreen allow="autoplay; encrypted-media"></iframe>
    </div>

    <script>
        const TMDB_KEY = "847629da5649502fa6655f73b15a5c8e";
        let currentId, currentType, currentS, currentE;

        async function loadShowcase() {
            const r1 = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${TMDB_KEY}&language=tr-TR&sort_by=popularity.desc&primary_release_year=2026`);
            const d1 = await r1.json();
            const r2 = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${TMDB_KEY}&language=tr-TR&sort_by=popularity.desc&primary_release_year=2025`);
            const d2 = await r2.json();
            displayItems([...d1.results, ...d2.results]);
        }

        async function searchContent() {
            const q = document.getElementById('searchInput').value;
            if(!q) return loadShowcase();
            const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB_KEY}&query=${encodeURIComponent(q)}&language=tr-TR`);
            const data = await res.json();
            displayItems(data.results);
        }

        function displayItems(items) {
            const container = document.getElementById('results'); container.innerHTML = "";
            items.forEach(item => {
                if(!item.poster_path) return;
                const type = item.media_type || (item.first_air_date ? 'tv' : 'movie');
                const btn = document.createElement('button');
                btn.className = "nav-item flex flex-col bg-transparent text-left";
                btn.innerHTML = `<img src="https://image.tmdb.org/t/p/w300${item.poster_path}" class="w-full aspect-[2/3] object-cover rounded-lg shadow-lg"><div class="poster-title truncate px-1">${item.title || item.name}</div>`;
                btn.onclick = () => openDetails(item.id, type);
                container.appendChild(btn);
            });
        }

        async function openDetails(id, type) {
            history.pushState({p:1}, null, "");
            currentId = id; currentType = type;
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB_KEY}&language=tr-TR&append_to_response=credits`);
            const data = await res.json();
            document.getElementById('detailTitle').innerText = data.title || data.name;
            document.getElementById('detailYear').innerText = (data.release_date || data.first_air_date || "2025").split('-')[0];
            document.getElementById('detailRating').innerText = "‚≠ê " + (data.vote_average?.toFixed(1) || "0.0");
            document.getElementById('detailPoster').src = `https://image.tmdb.org/t/p/w500${data.poster_path}`;
            const castDiv = document.getElementById('castList'); castDiv.innerHTML = "";
            data.credits.cast.slice(0, 8).forEach(actor => {
                const b = document.createElement('div');
                b.className = "bg-[#1a1a1a] px-3 py-2 rounded-xl text-[10px] text-gray-300 border border-white/5";
                b.innerText = actor.name;
                castDiv.appendChild(b);
            });
            document.getElementById('detailPage').classList.add('show-block');
        }

        async function startPlayback() {
            if(currentType === 'tv') {
                const res = await fetch(`https://api.themoviedb.org/3/tv/${currentId}?api_key=${TMDB_KEY}&language=tr-TR`);
                const data = await res.json();
                showSelectionList("SEZON SE√áƒ∞N", data.seasons.filter(s=>s.season_number > 0).map(s => ({
                    n: s.name, c: s.episode_count + " B√∂l√ºm", f: () => loadEpisodes(s.season_number)
                })));
            } else { openSources(); }
        }

        async function loadEpisodes(sNum) {
            currentS = sNum;
            const res = await fetch(`https://api.themoviedb.org/3/tv/${currentId}/season/${sNum}?api_key=${TMDB_KEY}&language=tr-TR`);
            const data = await res.json();
            showSelectionList("B√ñL√úM SE√áƒ∞N", data.episodes.map(e => ({
                n: `B√∂l√ºm ${e.episode_number}`, c: e.name, f: () => { currentE = e.episode_number; openSources(); }
            })));
        }

        function openSources() {
            showSelectionList("ANA YAYIN T√úR√ú", [
                {n:"üåê TORRENTIO (Hƒ±zlƒ±)", c:"En pop√ºler ve stabil P2P motoru", f:()=>fetchP2P('torrentio')},
                {n:"üöÄ ALTERNATƒ∞F P2P", c:"Webstream, KnightCrawler, Hayduk", f:()=>openAlternativeP2P()},
                {n:"üíé GELƒ∞≈ûMƒ∞≈û P2P (√ñzel)", c:"MediaFusion, TPB+, Brazuca", f:()=>openAdvancedP2P()},
                {n:"üáπüá∑ WEB STANDART", c:"Direkt izle (VidLink, VidSrc, 2Embed)", f:()=>openWebSources()}
            ]);
        }

        function openAlternativeP2P() {
            showSelectionList("ALTERNATƒ∞F MOTORLAR", [
                {n:"üåä WEBSTREAM", c:"Modern ve hƒ±zlƒ± web-torrent motoru", f:()=>fetchP2P('webstream')},
                {n:"‚öîÔ∏è KNIGHTCRAWLER", c:"B√ºy√ºk ar≈üiv yedeƒüi ve Jackett tarayƒ±cƒ±", f:()=>fetchP2P('knightcrawler')},
                {n:"üíÄ HAYDUK", c:"Nadir ve eski i√ßerik uzmanƒ±", f:()=>fetchP2P('hayduk')}
            ]);
        }

        function openAdvancedP2P() {
            showSelectionList("GELƒ∞≈ûMƒ∞≈û P2P MOTORLARI", [
                {n:"üî• MEDIAFUSION", c:"Geni≈ü k√ºresel ar≈üiv ve canlƒ± i√ßerikler", f:()=>fetchP2P('mediafusion')},
                {n:"üè¥‚Äç‚ò†Ô∏è THEPIRATEBAY+", c:"Efsanevi TPB k√ºt√ºphanesi", f:()=>fetchP2P('tpb')},
                {n:"üáßüá∑ BRAZUCA TORRENTS", c:"Agresif torrent tarayƒ±cƒ±", f:()=>fetchP2P('brazuca')}
            ]);
        }

        async function fetchP2P(engine) {
            showSelectionList("L√úTFEN BEKLEYƒ∞N", [{n:"Aranƒ±yor...", c: engine.toUpperCase() + " veritabanƒ± sorgulanƒ±yor", f:()=>{}}]);
            const extRes = await fetch(`https://api.themoviedb.org/3/${currentType}/${currentId}/external_ids?api_key=${TMDB_KEY}`);
            const extData = await extRes.json();
            const imdbId = extData.imdb_id;
            if(!imdbId) { alert("IMDB ID bulunamadƒ±."); openSources(); return; }

            const query = currentType === 'tv' ? `${imdbId}:${currentS}:${currentE}` : imdbId;
            const typePath = currentType === 'movie' ? 'movie' : 'series';
            
            let urls = {
                torrentio: `https://torrentio.strem.fun/providers=yts,eztv,rarbg,1337x,thepiratebay/stream/${typePath}/${query}.json`,
                webstream: `https://webio.elfhosted.com/stream/${typePath}/${query}.json`,
                knightcrawler: `https://knightcrawler.elfhosted.com/stream/${typePath}/${query}.json`,
                hayduk: `https://stremio-hayduk.onrender.com/stream/${typePath}/${query}.json`,
                mediafusion: `https://mediafusion.elfhosted.com/stream/${typePath}/${query}.json`,
                tpb: `https://stremio-tpb-plus.onrender.com/stream/${typePath}/${query}.json`,
                brazuca: `https://brazuca-torrents.elfhosted.com/stream/${typePath}/${query}.json`
            };

            try {
                const res = await fetch(urls[engine]);
                const data = await res.json();
                if(!data.streams || data.streams.length === 0) { alert("Link bulunamadƒ±."); openSources(); return; }
                
                const list = data.streams.map(s => ({
                    n: s.name.split('\n')[0],
                    c: s.title.split('\n')[0].substring(0, 60),
                    f: () => {
                        document.getElementById('playerFrame').src = s.url;
                        document.getElementById('videoLayer').style.display = 'flex';
                        closeModal('selectionModal');
                    }
                }));
                showSelectionList(engine.toUpperCase() + " SONU√áLARI", list);
            } catch(e) { alert("Motor hatasƒ±!"); openSources(); }
        }

        function openWebSources() {
            showSelectionList("WEB KAYNAKLARI", [
                {n:"VidLink üáπüá∑", c:"Dublaj & Altyazƒ± (En Stabil)", f:()=>play('vidlink')},
                {n:"VidSrc.me üáπüá∑", c:"Hƒ±zlƒ± Dublaj Ar≈üivi", f:()=>play('vidsrc_me')},
                {n:"2Embed (Full)", c:"Geni≈ü ve Sans√ºrs√ºz Ar≈üiv", f:()=>play('two_embed')},
                {n:"SuperEmbed", c:"Hƒ±zlƒ± Sunucu", f:()=>play('super')}
            ]);
        }

        function play(src) {
            const isT = currentType === 'tv';
            const urls = {
                vidlink: isT ? `https://vidlink.pro/tv/${currentId}/${currentS}/${currentE}?subs=tr` : `https://vidlink.pro/movie/${currentId}?subs=tr`,
                vidsrc_me: isT ? `https://vidsrc.me/embed/tv?tmdb=${currentId}&sea=${currentS}&epi=${currentE}` : `https://vidsrc.me/embed/movie?tmdb=${currentId}`,
                two_embed: isT ? `https://www.2embed.cc/embedtv/${currentId}&s=${currentS}&e=${currentE}` : `https://www.2embed.cc/embed/${currentId}`,
                super: isT ? `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1&s=${currentS}&e=${currentE}` : `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1`
            };
            document.getElementById('playerFrame').src = urls[src];
            document.getElementById('videoLayer').style.display = 'flex';
            closeModal('selectionModal');
        }

        function showSelectionList(title, items) {
            document.getElementById('modalTitle').innerText = title;
            const list = document.getElementById('modalList'); list.innerHTML = "";
            items.forEach(item => {
                const b = document.createElement('button');
                b.className = "nav-item w-full p-5 bg-[#1a1a1a] flex flex-col text-left mb-2 border border-white/5";
                b.innerHTML = `<div class="text-lg font-bold uppercase">${item.n}</div><div class="text-[11px] text-gray-500 mt-1 italic">${item.c}</div>`;
                b.onclick = item.f;
                list.appendChild(b);
            });
            document.getElementById('selectionModal').classList.add('show-modal');
            setTimeout(() => list.querySelector('button')?.focus(), 150);
        }

        function closePlayer() { 
            document.getElementById('playerFrame').src = ""; 
            document.getElementById('videoLayer').style.display = 'none'; 
            document.getElementById('selectionModal').classList.add('show-modal');
        }
        function closeModal(id) { document.getElementById(id).classList.remove('show-modal'); }
        function closeDetail() { document.getElementById('detailPage').classList.remove('show-block'); document.getElementById('searchInput').focus(); }
    </script>
</body>
</html>
