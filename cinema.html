<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SinemaTV Pro v33.6</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --n-red: #E50914; --n-black: #080808; }
        body { background-color: var(--n-black); color: white; font-family: sans-serif; margin: 0; padding: 5px; overflow-x: hidden; }
        
        /* AFİŞLER: Mobilde yan yana 4 tane */
        #results, #personCredits { display: grid; grid-template-cols: repeat(4, 1fr); gap: 6px; }
        @media (min-width: 768px) { #results, #personCredits { grid-template-cols: repeat(8, 1fr); } }

        /* MODALLAR (Üste Binme Mantığı) */
        .full-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); padding: 15px; overflow-y: auto; z-index: 2000; }
        .show-modal { display: block !important; }
        
        /* PIN EKRANI (Daha küçük bir kutu şeklinde üste biner) */
        .pin-container { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 3000; background: rgba(0,0,0,0.9); display: none; }
        .pin-box { background: #111; border: 1px solid #333; padding: 25px; border-radius: 20px; text-align: center; width: 90%; max-width: 320px; }
        .pin-input { background: #000; border: 2px solid #E50914; color: white; text-align: center; font-size: 24px; width: 140px; padding: 10px; border-radius: 10px; margin: 20px 0; outline: none; }
        
        .h-scroll { display: flex; overflow-x: auto; gap: 8px; width: 100%; padding: 10px 0; scrollbar-width: none; }
        .cast-card { flex: 0 0 60px; text-align: center; }
        .cast-card img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 1px solid #333; }
        
        /* Metadata Butonu Tasarımı */
        .metadata-btn {
            width: 100%;
            max-width: 280px;
            margin-top: 20px;
            padding: 12px;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 10px;
            color: #ccc;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
        }
        .metadata-btn:active { background: #222; transform: scale(0.98); }
    </style>
</head>
<body onload="initApp()">

    <div id="mainUI">
        <header class="flex flex-col items-center mb-4">
            <h1 class="text-xl font-black italic text-red-600 my-2">Sinema<span class="text-white">TV PRO</span></h1>
            <div class="flex w-full gap-2 px-1">
                <input type="text" id="searchInput" placeholder="Film veya oyuncu..." class="bg-[#1a1a1a] p-2 flex-1 rounded-lg outline-none text-sm text-white border-none">
                <button onclick="resetAndSearch()" class="bg-[#E50914] px-4 rounded-lg text-white"><i class="fas fa-search"></i></button>
            </div>
        </header>
        <div id="results"></div>
        <button id="loadMoreMain" onclick="loadMoreContent()" class="w-full mt-6 mb-10 py-3 bg-white/5 rounded-lg text-[10px] font-bold text-gray-500 uppercase">Daha Fazla</button>
    </div>

    <div id="pinOverlay" class="pin-container" onclick="if(event.target == this) closePin()">
        <div class="pin-box">
            <h3 class="text-white font-bold text-sm uppercase">GÜVENLİK KODU</h3>
            <p class="text-[10px] text-gray-500 mt-1">Lütfen 4 haneli PIN girin</p>
            <input type="password" id="pinInput" maxlength="4" class="pin-input">
            <div class="flex gap-2">
                <button onclick="closePin()" class="flex-1 py-3 bg-gray-800 rounded-lg text-xs font-bold">İPTAL</button>
                <button onclick="checkPin()" class="flex-1 py-3 bg-red-600 rounded-lg text-xs font-bold">ONAYLA</button>
            </div>
        </div>
    </div>

    <div id="externalModal" class="full-modal">
        <div class="max-w-md mx-auto">
            <button onclick="document.getElementById('externalModal').classList.remove('show-modal')" class="mb-6 bg-white/10 px-6 py-2 rounded-full text-xs font-bold uppercase">← GERİ</button>
            <h2 class="text-lg font-black text-red-600 mb-6 uppercase">HARİCİ KAYNAKLAR</h2>
            <div id="externalList" class="flex flex-col gap-3"></div>
        </div>
    </div>

    <div id="detailPage" class="full-modal">
        <button onclick="history.back()" class="mb-4 bg-white/10 px-5 py-2 rounded-full text-xs font-bold uppercase">← KAPAT</button>
        <div class="flex flex-col items-center">
            <img id="detailPoster" src="" class="max-h-[220px] rounded-xl shadow-2xl mb-4">
            <h2 id="detailTitle" class="text-lg font-black text-center px-4"></h2>
            
            <div id="castList" class="h-scroll mt-4"></div>
            
            <button onclick="startAutoPlay()" class="bg-[#E50914] w-full max-w-xs py-4 mt-6 rounded-xl font-black text-sm text-white shadow-lg">▶ ŞİMDİ İZLE</button>
            
            <button onclick="openPin()" class="metadata-btn">
                <i class="fas fa-database text-red-600"></i> METADATA
            </button>
        </div>
    </div>

    <div id="personPage" class="full-modal">
        <button onclick="history.back()" class="mb-4 bg-white/10 px-5 py-2 rounded-full text-xs font-bold uppercase">← GERİ</button>
        <div id="personName" class="text-xl font-bold text-red-600 text-center mb-6"></div>
        <div id="personCredits"></div>
    </div>

    <div id="videoLayer">
        <div class="p-2 bg-black flex justify-between items-center border-b border-white/10">
            <button onclick="closePlayer()" class="bg-white/10 px-4 py-1.5 rounded-full text-[9px] font-bold">KAPAT</button>
            <div class="text-[8px] text-gray-500 font-bold uppercase tracking-widest">SERVER 01</div>
        </div>
        <iframe id="playerFrame" src="" class="flex-1 w-full border-none" allowfullscreen></iframe>
    </div>

    <script>
        const TMDB_KEY = "847629da5649502fa6655f73b15a5c8e";
        const SAFE_PIN = "1739";
        let mainPage = 1, currentItem = {};

        function initApp() { loadContent(); }

        async function loadContent(page = 1) {
            const q = document.getElementById('searchInput').value;
            let url = q ? `https://api.themoviedb.org/3/search/multi?api_key=${TMDB_KEY}&query=${encodeURIComponent(q)}&language=tr-TR&page=${page}`
                        : `https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB_KEY}&language=tr-TR&page=${page}`;
            const res = await fetch(url);
            const data = await res.json();
            displayItems(data.results, 'results', page > 1);
            document.getElementById('loadMoreMain').style.display = data.page < data.total_pages ? 'block' : 'none';
        }

        function resetAndSearch() { mainPage = 1; document.getElementById('results').innerHTML = ""; loadContent(1); }
        function loadMoreContent() { mainPage++; loadContent(mainPage); }

        function displayItems(items, targetId, append = false) {
            const container = document.getElementById(targetId);
            if(!append) container.innerHTML = "";
            items.forEach(item => {
                if(item.poster_path) {
                    const btn = document.createElement('div');
                    btn.className = "flex flex-col cursor-pointer";
                    btn.innerHTML = `<img src="https://image.tmdb.org/t/p/w300${item.poster_path}" class="rounded-lg aspect-[2/3] object-cover"><div class="text-[7px] font-bold truncate mt-1 uppercase text-center text-gray-600">${item.title || item.name}</div>`;
                    btn.onclick = () => { history.pushState({view:'detail'}, ""); openDetails(item.id, item.media_type || (item.first_air_date ? 'tv' : 'movie')); };
                    container.appendChild(btn);
                }
            });
        }

        // PIN MANTIĞI
        function openPin() {
            document.getElementById('pinInput').value = "";
            document.getElementById('pinOverlay').style.display = "flex";
        }
        function closePin() { document.getElementById('pinOverlay').style.display = "none"; }

        function checkPin() {
            if(document.getElementById('pinInput').value === SAFE_PIN) {
                closePin();
                openExternalMenu();
            } else {
                alert("Hatalı PIN!");
                document.getElementById('pinInput').value = "";
            }
        }

        function openExternalMenu() {
            const list = document.getElementById('externalList');
            list.innerHTML = "";
            const sources = [
                {n:"EROGARGA", s:"erogarga"}, {n:"TUBE PORN CLASSIC", s:"tpc"}, 
                {n:"XNXX", s:"xnxx"}, {n:"XVIDEOS", s:"xvideos"}, {n:"NOODLE MAGAZINE", s:"noodle"}
            ];
            sources.forEach(src => {
                const b = document.createElement('button');
                b.className = "bg-[#111] p-5 rounded-xl text-left text-xs font-black tracking-widest text-white border border-white/5 active:bg-red-900";
                b.innerText = src.n;
                b.onclick = () => searchExternal(src.s);
                list.appendChild(b);
            });
            document.getElementById('externalModal').classList.add('show-modal');
        }

        function searchExternal(site) {
            const cleanTitle = currentItem.title.split('(')[0].trim();
            const q = encodeURIComponent(cleanTitle);
            const urls = {
                erogarga: `https://www.erogarga.com/?s=${q}`,
                tpc: `https://tubepornclassic.com/search/1/?s=${q}`,
                noodle: `https://noodlemagazine.com/video/${q}`,
                xnxx: `https://www.xnxx.com/search/${q.replace(/%20/g, '+')}`,
                xvideos: `https://www.xvideos.com/?k=${q.replace(/%20/g, '+')}`
            };
            window.open(urls[site], '_blank');
        }

        async function openDetails(id, type) {
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB_KEY}&language=tr-TR&append_to_response=credits`);
            const data = await res.json();
            currentItem = { id, type, title: data.title || data.name };
            document.getElementById('detailTitle').innerText = currentItem.title;
            document.getElementById('detailPoster').src = `https://image.tmdb.org/t/p/w500${data.poster_path}`;
            const castDiv = document.getElementById('castList'); castDiv.innerHTML = "";
            data.credits.cast.slice(0, 10).forEach(p => {
                const card = document.createElement('div'); card.className = "cast-card";
                card.innerHTML = `<img src="https://image.tmdb.org/t/p/w185${p.profile_path || ''}" onerror="this.src='https://via.placeholder.com/100'"><div class="text-[6px] mt-1 truncate font-medium text-gray-400">${p.name}</div>`;
                card.onclick = () => { history.pushState({view:'person'}, ""); openPersonDetails(p.id); };
                castDiv.appendChild(card);
            });
            document.getElementById('detailPage').classList.add('show-modal');
        }

        async function openPersonDetails(id) {
            const res = await fetch(`https://api.themoviedb.org/3/person/${id}?api_key=${TMDB_KEY}&language=tr-TR&append_to_response=combined_credits`);
            const data = await res.json();
            document.getElementById('personName').innerText = data.name;
            displayItems(data.combined_credits.cast.sort((a,b)=>b.vote_count-a.vote_count).slice(0,16), 'personCredits', false);
            document.getElementById('personPage').classList.add('show-modal');
        }

        function startAutoPlay() {
            const url = currentItem.type === 'tv' ? `https://vidsrc.me/embed/tv?tmdb=${currentItem.id}&sea=1&epi=1&ds_lang=tr` : `https://vidsrc.me/embed/movie?tmdb=${currentItem.id}&ds_lang=tr`;
            document.getElementById('playerFrame').src = url;
            document.getElementById('videoLayer').style.display = 'flex';
        }

        function closePlayer() { document.getElementById('playerFrame').src = ""; document.getElementById('videoLayer').style.display = 'none'; }
        
        window.onpopstate = () => { 
            closePlayer(); closePin(); 
            document.getElementById('externalModal').classList.remove('show-modal'); 
            document.getElementById('personPage').classList.remove('show-modal'); 
            document.getElementById('detailPage').classList.remove('show-modal'); 
        };
    </script>
</body>
</html>