<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SinemaTV PRO</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
:root{--red:#E50914;--black:#080808}
body{background:var(--black);color:#fff;margin:0;padding:10px;font-family:sans-serif;overflow:hidden}
.nav-item{cursor:pointer;border-radius:12px;transition:.15s}
.full-modal{display:none!important;position:fixed;inset:0;background:rgba(0,0,0,.97);overflow-y:auto}
.show{display:flex!important}
#results{height:calc(100vh - 160px);overflow-y:auto}
.topbar{display:flex;gap:8px;margin-bottom:10px}
</style>
</head>

<body onload="loadHome()">

<header class="text-center mb-4">
<h1 class="text-3xl font-black italic text-red-600">SinemaTV PRO</h1>
<div class="flex gap-2 mt-3">
<input id="searchInput" placeholder="Film / Dizi / Oyuncu"
 class="flex-1 p-3 bg-[#1a1a1a] rounded-xl nav-item">
<button onclick="search()" class="px-6 bg-red-600 rounded-xl font-bold nav-item">ARA</button>
</div>
</header>

<div id="results" class="grid grid-cols-3 gap-4"></div>

<!-- DETAIL -->
<div id="detailPage" class="full-modal flex-col p-6">
<div class="topbar">
<button onclick="goHome()" class="nav-item px-4 py-2 bg-[#222]">üè†</button>
<button onclick="goBack()" class="nav-item px-4 py-2 bg-[#222]">‚Üê</button>
</div>
<img id="detailPoster" class="max-h-[260px] rounded-xl mx-auto mb-4">
<h2 id="detailTitle" class="text-xl font-black text-center mb-3"></h2>
<div id="castList" class="flex flex-wrap gap-2 justify-center mb-6"></div>
<button onclick="openSources()" class="bg-red-600 px-8 py-4 rounded-xl font-black nav-item mx-auto">‚ñ∂ ƒ∞ZLE</button>
</div>

<!-- ACTOR -->
<div id="actorPage" class="full-modal flex-col p-6">
<div class="topbar">
<button onclick="goHome()" class="nav-item px-4 py-2 bg-[#222]">üè†</button>
<button onclick="goBack()" class="nav-item px-4 py-2 bg-[#222]">‚Üê</button>
</div>
<img id="actorPhoto" class="w-32 h-32 rounded-full mx-auto mb-3 object-cover">
<h2 id="actorName" class="text-xl font-black text-center mb-2"></h2>
<p id="actorBio" class="text-xs text-gray-400 text-center mb-4"></p>
<div id="actorFilms" class="grid grid-cols-3 gap-4"></div>
</div>

<!-- SOURCES -->
<div id="sourcesPage" class="full-modal flex-col p-6">
<div class="topbar">
<button onclick="goHome()" class="nav-item px-4 py-2 bg-[#222]">üè†</button>
<button onclick="goBack()" class="nav-item px-4 py-2 bg-[#222]">‚Üê</button>
</div>
<div id="sourcesList" class="space-y-3"></div>
</div>

<!-- PIN -->
<div id="pinPage" class="full-modal flex-col items-center justify-center p-6">
<h2 class="font-black mb-3">PIN Gƒ∞R</h2>
<input id="pinInput" type="password" maxlength="4"
 class="text-center text-2xl bg-black border border-red-600 p-2 mb-4 w-32">
<div class="flex gap-2">
<button onclick="goBack()" class="bg-gray-600 px-4 py-2 rounded">ƒ∞PTAL</button>
<button onclick="checkPin()" class="bg-red-600 px-4 py-2 rounded">OK</button>
</div>
</div>

<!-- PLAYER -->
<div id="playerPage" class="full-modal flex-col">
<button onclick="goBack()" class="m-3 bg-white/10 px-6 py-2 rounded-full nav-item">‚Üê KAPAT</button>
<iframe id="playerFrame" class="flex-1 w-full" allowfullscreen></iframe>
</div>

<script>
const TMDB="847629da5649502fa6655f73b15a5c8e";
const PIN="1234";

let stack=[];
let current={};

/* ================= STATE ================= */

function push(state){
  stack.push(JSON.parse(JSON.stringify(state)));
}

function goBack(){
  if(stack.length<=1) return;
  stack.pop();
  restore(stack[stack.length-1]);
}

function goHome(){
  stack=[];
  loadHome();
}

function hideAll(){
  detailPage.classList.remove("show");
  actorPage.classList.remove("show");
  sourcesPage.classList.remove("show");
  pinPage.classList.remove("show");
  playerPage.classList.remove("show");
}

/* ================= HOME ================= */

async function loadHome(){
  push({view:"home"});
  hideAll();
  const r=await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB}&language=tr`);
  renderList((await r.json()).results);
}

async function search(){
  const q=searchInput.value.trim();
  if(!q) return loadHome();
  push({view:"search",q});
  const r=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB}&query=${q}&language=tr`);
  renderList((await r.json()).results);
}

function renderList(items){
  hideAll();
  results.innerHTML="";
  items.forEach(i=>{
    if(!i.poster_path) return;
    const type=i.media_type||(i.first_air_date?"tv":"movie");
    const b=document.createElement("button");
    b.className="nav-item";
    b.innerHTML=`<img src="https://image.tmdb.org/t/p/w300${i.poster_path}" class="rounded-lg"><div class="text-[10px] truncate">${i.title||i.name}</div>`;
    b.onclick=()=>openDetail(i.id,type);
    results.appendChild(b);
  });
}

/* ================= DETAIL ================= */

async function openDetail(id,type){
  push({view:"detail",id,type});
  hideAll();
  const r=await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB}&language=tr&append_to_response=credits,external_ids`);
  const d=await r.json();
  current={id,type,imdb:d.external_ids.imdb_id,title:d.title||d.name};
  detailPoster.src=`https://image.tmdb.org/t/p/w500${d.poster_path}`;
  detailTitle.innerText=current.title;
  castList.innerHTML="";
  d.credits.cast.slice(0,8).forEach(a=>{
    const c=document.createElement("button");
    c.className="nav-item bg-[#222] px-3 py-1 text-xs rounded-full";
    c.innerText=a.name;
    c.onclick=()=>openActor(a.id);
    castList.appendChild(c);
  });
  detailPage.classList.add("show");
}

/* ================= ACTOR ================= */

async function openActor(id){
  push({view:"actor",id});
  hideAll();
  const r=await fetch(`https://api.themoviedb.org/3/person/${id}?api_key=${TMDB}&language=tr&append_to_response=combined_credits`);
  const d=await r.json();
  actorName.innerText=d.name;
  actorBio.innerText=d.biography||"";
  actorPhoto.src=d.profile_path?`https://image.tmdb.org/t/p/w300${d.profile_path}`:"";
  actorFilms.innerHTML="";
  d.combined_credits.cast.filter(x=>x.poster_path).forEach(i=>{
    const type=i.media_type==="tv"?"tv":"movie";
    const b=document.createElement("button");
    b.className="nav-item";
    b.innerHTML=`<img src="https://image.tmdb.org/t/p/w300${i.poster_path}" class="rounded-lg"><div class="text-[10px] truncate">${i.title||i.name}</div>`;
    b.onclick=()=>openDetail(i.id,type);
    actorFilms.appendChild(b);
  });
  actorPage.classList.add("show");
}

/* ================= SOURCES / PIN / PLAYER ================= */

function openSources(){
  push({view:"sources"});
  hideAll();
  sourcesList.innerHTML="";
  ["VIDSRC","VIDLINK","SUPEREMBED","EROGARGA","XNXX"].forEach(s=>{
    const b=document.createElement("button");
    b.className="w-full bg-[#222] p-3 rounded nav-item";
    b.innerText=s;
    b.onclick=()=>openPin(s);
    sourcesList.appendChild(b);
  });
  sourcesPage.classList.add("show");
}

function openPin(src){
  push({view:"pin",src});
  hideAll();
  pinPage.classList.add("show");
}

function checkPin(){
  if(pinInput.value!==PIN) return alert("Hatalƒ± PIN");
  const s=stack[stack.length-1].src;
  push({view:"player",src:s});
  hideAll();
  play(s);
}

function play(src){
  let url="";
  if(src==="VIDSRC") url=`https://vidsrc.me/embed/movie?tmdb=${current.id}`;
  if(src==="VIDLINK") url=`https://vidlink.pro/movie/${current.id}`;
  if(src==="SUPEREMBED") url=`https://multiembed.mov/?video_id=${current.id}&tmdb=1`;
  if(src==="EROGARGA") url=`https://www.erogarga.com/?s=${encodeURIComponent(current.title)}`;
  if(src==="XNXX") url=`https://www.xnxx.com/search/${encodeURIComponent(current.title)}`;
  playerFrame.src=url;
  playerPage.classList.add("show");
}

/* ================= RESTORE ================= */

function restore(s){
  if(s.view==="home") loadHome();
  if(s.view==="search"){searchInput.value=s.q;search();}
  if(s.view==="detail") openDetail(s.id,s.type);
  if(s.view==="actor") openActor(s.id);
  if(s.view==="sources") openSources();
  if(s.view==="pin") openPin(s.src);
  if(s.view==="player") play(s.src);
}
</script>
</body>
</html>