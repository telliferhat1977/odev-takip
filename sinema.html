<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SinemaTV Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --n-red: #E50914; --n-black: #141414; }
        body { background-color: var(--n-black); color: white; font-family: sans-serif; margin: 0; }
        .nav-item { transition: all 0.2s; border: 3px solid transparent; }
        .nav-item:focus { border-color: white; transform: scale(1.02); outline: none; background: #333; }
        .full-modal { display: none; position: fixed; inset: 0; background: var(--n-black); z-index: 1000; overflow-y: auto; padding: 20px; }
        .video-layer { display: none; position: fixed; inset: 0; background: black; z-index: 2000; flex-direction: column; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #E50914; border-radius: 10px; }
    </style>
</head>
<body class="p-6 md:p-10">

    <div id="mainUI">
        <header class="flex flex-col md:flex-row items-center justify-between mb-10 gap-4">
            <h1 class="text-4xl font-black text-[#E50914] tracking-tighter">Sƒ∞NEMA<span class="text-white">TV</span></h1>
            <div class="flex w-full md:w-auto gap-2">
                <input type="text" id="searchInput" placeholder="Film, Dizi veya Oyuncu..." class="bg-[#222] p-4 flex-1 md:w-80 rounded-xl outline-none focus:bg-[#333]">
                <button onclick="searchContent()" class="nav-item bg-[#E50914] px-8 py-4 rounded-xl font-bold uppercase">ARA</button>
            </div>
        </header>
        <div id="results" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-6"></div>
    </div>

    <div id="detailPage" class="full-modal md:p-20">
        <button onclick="closeDetail()" class="nav-item mb-8 bg-white/10 px-8 py-3 rounded-full font-bold">‚Üê GERƒ∞ D√ñN</button>
        <div class="flex flex-col md:flex-row gap-12">
            <img id="detailPoster" class="w-full md:w-96 rounded-3xl shadow-2xl">
            <div class="flex-1">
                <h2 id="detailTitle" class="text-4xl md:text-7xl font-black mb-6"></h2>
                <div class="flex gap-4 mb-6 text-lg">
                    <span id="detailRating" class="text-yellow-500 font-bold"></span>
                    <span id="detailYear" class="text-gray-400 font-medium"></span>
                </div>
                <p id="detailOverview" class="text-gray-300 text-xl leading-relaxed mb-10 max-w-3xl"></p>
                <h3 class="text-red-500 font-bold mb-4 uppercase tracking-widest">Oyuncu Kadrosu</h3>
                <div id="detailCast" class="flex flex-wrap gap-3 mb-12"></div>
                <button onclick="checkTypeAndPlay()" class="nav-item bg-[#E50914] w-full md:w-auto px-16 py-6 rounded-2xl font-black text-2xl shadow-xl">‚ñ∂ ≈ûƒ∞MDƒ∞ ƒ∞ZLE</button>
            </div>
        </div>
    </div>

    <div id="episodeModal" class="full-modal bg-black/95 flex items-center justify-center" style="z-index: 1500;">
        <div class="bg-[#181818] w-full max-w-2xl p-8 rounded-3xl border border-gray-800 shadow-2xl">
            <h2 id="modalTitle" class="text-2xl font-bold mb-6 text-red-500">Sezon Se√ßin</h2>
            <div id="episodeList" class="max-h-[50vh] overflow-y-auto pr-4"></div>
            <button onclick="document.getElementById('episodeModal').style.display='none'" class="nav-item mt-6 w-full p-4 bg-gray-800 rounded-xl font-bold">ƒ∞PTAL</button>
        </div>
    </div>

    <div id="sourceModal" class="full-modal bg-black/90 flex items-center justify-center" style="z-index: 1600;">
        <div class="bg-[#1a1a1a] p-8 rounded-3xl border border-gray-700 w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold mb-8 text-white">Yayƒ±n Kaynaƒüƒ±</h2>
            <div class="flex flex-col gap-4">
                <button onclick="finalPlay('vidlink')" class="nav-item bg-blue-600 p-5 rounded-2xl font-black uppercase">KAYNAK 1 (HIZLI)</button>
                <button onclick="finalPlay('vidsrc_to')" class="nav-item bg-red-700 p-5 rounded-2xl font-black uppercase">KAYNAK 2 (GENƒ∞≈û)</button>
                <button onclick="finalPlay('vidsrc_me')" class="nav-item bg-indigo-700 p-5 rounded-2xl font-black uppercase">KAYNAK 3 (STABƒ∞L)</button>
                <button onclick="finalPlay('superembed')" class="nav-item bg-orange-700 p-5 rounded-2xl font-black uppercase">KAYNAK 4 (YEDEK)</button>
            </div>
            <button onclick="document.getElementById('sourceModal').style.display='none'" class="mt-6 text-gray-500 underline text-xs">Vazge√ß</button>
        </div>
    </div>

    <div id="videoLayer" class="video-layer">
        <div class="p-4 bg-black flex justify-between">
            <button onclick="closePlayer()" class="nav-item bg-white/10 px-6 py-2 rounded-full font-bold">‚Üê</button>
            <button onclick="makeFullScreen()" class="nav-item bg-red-600 px-6 py-2 rounded-full font-bold">üì∫</button>
        </div>
        <iframe id="playerFrame" src="" class="flex-1 w-full border-none" allowfullscreen allow="autoplay"></iframe>
    </div>

    <script>
        const API_KEY = "847629da5649502fa6655f73b15a5c8e";
        let currentId, currentType, currentTitle, currentS, currentE;

        async function searchContent(query) {
            const q = query || document.getElementById('searchInput').value;
            if(!q) return;
            const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(q)}&language=tr-TR`);
            const data = await res.json();
            const container = document.getElementById('results');
            container.innerHTML = "";
            data.results.forEach(item => {
                if(!item.poster_path && !item.profile_path) return;
                const btn = document.createElement('button');
                btn.className = "nav-item rounded-2xl overflow-hidden bg-[#1a1a1a] shadow-lg text-left";
                const img = item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : `https://image.tmdb.org/t/p/w500${item.profile_path}`;
                btn.innerHTML = `<img src="${img}" class="w-full aspect-[2/3] object-cover"><div class="p-3 text-xs font-bold truncate">${item.title || item.name}</div>`;
                btn.onclick = () => {
                    if(item.media_type === 'person') loadActorWorks(item.id, item.name);
                    else openDetails(item.id, item.media_type);
                };
                container.appendChild(btn);
            });
            closeDetail();
        }

        async function loadActorWorks(personId, personName) {
            const res = await fetch(`https://api.themoviedb.org/3/person/${personId}/combined_credits?api_key=${API_KEY}&language=tr-TR`);
            const data = await res.json();
            const container = document.getElementById('results');
            container.innerHTML = "";
            document.getElementById('searchInput').value = personName;
            // Pop√ºlerliƒüe g√∂re sƒ±rala
            const works = data.cast.sort((a, b) => b.vote_count - a.vote_count);
            works.forEach(item => {
                if(!item.poster_path) return;
                const btn = document.createElement('button');
                btn.className = "nav-item rounded-2xl overflow-hidden bg-[#1a1a1a]";
                btn.innerHTML = `<img src="https://image.tmdb.org/t/p/w500${item.poster_path}" class="w-full aspect-[2/3] object-cover"><div class="p-3 text-[10px] font-bold truncate">${item.title || item.name}</div>`;
                btn.onclick = () => openDetails(item.id, item.media_type || (item.first_air_date ? 'tv' : 'movie'));
                container.appendChild(btn);
            });
            window.scrollTo(0,0);
        }

        async function openDetails(id, type) {
            currentId = id; currentType = type;
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=tr-TR&append_to_response=credits`);
            const data = await res.json();
            currentTitle = data.title || data.name;
            document.getElementById('detailTitle').innerText = currentTitle;
            document.getElementById('detailOverview').innerText = data.overview || "Konu hen√ºz eklenmemi≈ü.";
            document.getElementById('detailRating').innerText = "‚≠ê " + (data.vote_average ? data.vote_average.toFixed(1) : "N/A");
            document.getElementById('detailYear').innerText = (data.release_date || data.first_air_date || "").split('-')[0];
            document.getElementById('detailPoster').src = `https://image.tmdb.org/t/p/w500${data.poster_path}`;
            
            const castContainer = document.getElementById('detailCast');
            castContainer.innerHTML = "";
            data.credits.cast.slice(0, 8).forEach(actor => {
                const b = document.createElement('button');
                b.className = "nav-item bg-[#222] px-5 py-2 rounded-full text-xs font-bold hover:bg-red-600";
                b.innerText = actor.name;
                b.onclick = () => loadActorWorks(actor.id, actor.name);
                castContainer.appendChild(b);
            });
            document.getElementById('detailPage').style.display = 'block';
        }

        async function checkTypeAndPlay() {
            if(currentType === 'tv') {
                const res = await fetch(`https://api.themoviedb.org/3/tv/${currentId}?api_key=${API_KEY}&language=tr-TR`);
                const data = await res.json();
                loadSeasons(data.seasons);
            } else {
                document.getElementById('sourceModal').style.display = 'flex';
            }
        }

        function loadSeasons(seasons) {
            const list = document.getElementById('episodeList');
            list.innerHTML = "";
            document.getElementById('modalTitle').innerText = "Sezon Se√ßin";
            seasons.forEach(s => {
                if(s.season_number === 0) return;
                const b = document.createElement('button');
                b.className = "nav-item w-full text-left p-5 bg-[#222] rounded-2xl mb-3 font-bold flex justify-between";
                b.innerHTML = `<span>${s.name}</span> <span class="text-red-500">${s.episode_count} B√∂l√ºm</span>`;
                b.onclick = () => loadEpisodes(s.season_number);
                list.appendChild(b);
            });
            document.getElementById('episodeModal').style.display = 'flex';
        }

        async function loadEpisodes(sNum) {
            currentS = sNum;
            const res = await fetch(`https://api.themoviedb.org/3/tv/${currentId}/season/${sNum}?api_key=${API_KEY}&language=tr-TR`);
            const data = await res.json();
            const list = document.getElementById('episodeList');
            list.innerHTML = "";
            document.getElementById('modalTitle').innerText = sNum + ". Sezon B√∂l√ºmleri";
            data.episodes.forEach(ep => {
                const b = document.createElement('button');
                b.className = "nav-item w-full text-left p-4 bg-[#222] rounded-xl mb-2 text-sm";
                b.innerText = `${ep.episode_number}. ${ep.name}`;
                b.onclick = () => { currentE = ep.episode_number; document.getElementById('sourceModal').style.display = 'flex'; };
                list.appendChild(b);
            });
        }

        function finalPlay(provider) {
            let url = "";
            const isTV = currentType === 'tv';
            if(provider === 'vidlink') url = isTV ? `https://vidlink.pro/tv/${currentId}/${currentS}/${currentE}` : `https://vidlink.pro/movie/${currentId}`;
            if(provider === 'vidsrc_to') url = isTV ? `https://vidsrc.to/embed/tv/${currentId}/${currentS}/${currentE}` : `https://vidsrc.to/embed/movie/${currentId}`;
            if(provider === 'vidsrc_me') url = isTV ? `https://vidsrc.me/embed/tv?tmdb=${currentId}&sea=${currentS}&epi=${currentE}` : `https://vidsrc.me/embed/movie?tmdb=${currentId}`;
            if(provider === 'superembed') url = isTV ? `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1&s=${currentS}&e=${currentE}` : `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1`;
            
            document.getElementById('playerFrame').src = url;
            document.getElementById('videoLayer').style.display = 'flex';
        }

        function closeDetail() { document.getElementById('detailPage').style.display = 'none'; }
        function closePlayer() { document.getElementById('playerFrame').src = ""; document.getElementById('videoLayer').style.display = 'none'; }
        function makeFullScreen() { const f = document.getElementById('playerFrame'); if(f.requestFullscreen) f.requestFullscreen(); else if(f.webkitRequestFullscreen) f.webkitRequestFullscreen(); }
        document.getElementById("searchInput").addEventListener("keypress", (e) => { if (e.key === "Enter") searchContent(); });
    </script>
</body>
</html>
