<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SinemaTV PRO</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
:root { --red:#E50914; }
body{background:#080808;color:white;margin:0;padding:10px;overflow:hidden}
.nav-item{transition:.2s;cursor:pointer;border:2px solid transparent;border-radius:12px}
.nav-item:focus{border-color:white;background:var(--red);transform:scale(1.05)}
.full-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.97);z-index:1000;overflow:auto}
.show{display:flex}
</style>
</head>

<body onload="init()">

<header class="text-center mb-3">
<h1 class="text-3xl font-black italic text-red-600">SinemaTV <span class="text-white">PRO</span></h1>

<div class="flex gap-2 mt-3">
<input id="searchInput" class="flex-1 p-3 bg-[#1a1a1a] rounded-xl text-sm nav-item"
 placeholder="Film, Dizi veya Oyuncu">
<button onclick="search()" class="px-6 bg-red-600 rounded-xl font-bold nav-item">ARA</button>
</div>

<div class="flex gap-2 mt-2 text-xs">
<button onclick="setFilter('all')" class="nav-item px-3 py-1 bg-gray-700">T√ºm√º</button>
<button onclick="setFilter('movie')" class="nav-item px-3 py-1 bg-gray-700">Filmler</button>
<button onclick="setFilter('tv')" class="nav-item px-3 py-1 bg-gray-700">Diziler</button>
<button onclick="clearHistory()" class="nav-item px-3 py-1 bg-red-700">Ge√ßmi≈üi Sil</button>
</div>
</header>

<div id="results" class="grid grid-cols-3 md:grid-cols-6 gap-4"></div>

<!-- DETAY -->
<div id="detail" class="full-modal flex-col items-center p-6">
<button onclick="closeDetail()" class="mb-4 nav-item px-6 py-2 bg-gray-700">‚Üê Geri</button>

<img id="dPoster" class="h-64 rounded-xl mb-3">
<h2 id="dTitle" class="text-2xl font-black mb-2"></h2>

<div id="cast" class="flex flex-wrap gap-2 mb-4"></div>

<button onclick="openSources()" class="bg-red-600 px-8 py-4 rounded-xl nav-item font-bold">
‚ñ∂ ƒ∞zle
</button>

<button id="restartBtn" onclick="restart()" class="hidden mt-2 bg-gray-700 px-6 py-2 rounded-xl nav-item">
üîÅ Ba≈ütan ƒ∞zle
</button>
</div>

<!-- KAYNAK -->
<div id="sources" class="full-modal flex-col items-center p-6">
<button onclick="closeSources()" class="mb-4 nav-item px-6 py-2 bg-gray-700">‚Üê Geri</button>

<div class="space-y-2 w-full max-w-md">
<button onclick="play('vidsrcme')" class="nav-item w-full p-4 bg-[#1a1a1a]">VIDSRC.ME</button>
<button onclick="play('vidlink')" class="nav-item w-full p-4 bg-[#1a1a1a]">VIDLINK</button>
<button onclick="play('vidsrc')" class="nav-item w-full p-4 bg-[#1a1a1a]">VIDSRC.XYZ</button>
<button onclick="play('super')" class="nav-item w-full p-4 bg-[#1a1a1a]">SUPEREMBED</button>
<button onclick="openPin()" class="nav-item w-full p-4 bg-red-700">HARƒ∞Cƒ∞ KAYNAKLAR</button>
</div>
</div>

<!-- PIN -->
<div id="pin" class="full-modal flex items-center justify-center">
<div class="bg-[#111] p-8 rounded-2xl text-center">
<h2 class="mb-4 text-red-600 font-black">PIN</h2>
<input id="pinInput" type="password" maxlength="4"
 class="text-black text-xl text-center w-32 p-2 rounded mb-4">
<div class="flex gap-2">
<button onclick="closePin()" class="px-4 py-2 bg-gray-700 nav-item">ƒ∞ptal</button>
<button onclick="checkPin()" class="px-4 py-2 bg-red-600 nav-item">Onay</button>
</div>
</div>
</div>

<!-- PLAYER -->
<div id="player" class="full-modal flex-col">
<button onclick="closePlayer()" class="p-3 bg-gray-800 nav-item">‚Üê Kapat</button>
<iframe id="frame" class="flex-1 w-full" allowfullscreen></iframe>
</div>

<script>
const TMDB="847629da5649502fa6655f73b15a5c8e";
const PIN="1234";

let filter="all";
let current,currentType;
let history=JSON.parse(localStorage.getItem("history")||"[]");

function init(){ loadTrending(); }

function setFilter(f){filter=f;search();}

async function loadTrending(){
let r=await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB}&language=tr`);
let d=await r.json();
render(d.results);
}

async function search(){
let q=searchInput.value;
if(!q){loadTrending();return;}
let r=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB}&query=${q}&language=tr`);
let d=await r.json();
render(d.results);
}

function render(list){
results.innerHTML="";
list.filter(i=>i.poster_path)
.filter(i=>filter==="all"||i.media_type===filter)
.forEach(i=>{
let b=document.createElement("button");
b.className="nav-item";
b.innerHTML=`<img src="https://image.tmdb.org/t/p/w300${i.poster_path}" class="rounded">
<div class="text-xs mt-1 truncate">${i.title||i.name}</div>`;
b.onclick=()=>openDetail(i.id,i.media_type||"movie");
results.appendChild(b);
});
}

async function openDetail(id,type){
current=id;currentType=type;
let r=await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB}&language=tr&append_to_response=credits`);
let d=await r.json();

dPoster.src=`https://image.tmdb.org/t/p/w500${d.poster_path}`;
dTitle.innerText=d.title||d.name;

cast.innerHTML="";
d.credits.cast.slice(0,6).forEach(c=>{
let b=document.createElement("button");
b.className="nav-item bg-[#1a1a1a] px-2 py-1 text-xs";
b.innerHTML=`<img src="https://image.tmdb.org/t/p/w185${c.profile_path}" class="w-8 h-8 rounded-full inline mr-1">${c.name}`;
b.onclick=()=>searchActor(c.id,c.name);
cast.appendChild(b);
});

detail.classList.add("show");
}

async function searchActor(id,name){
searchInput.value=name;
let r=await fetch(`https://api.themoviedb.org/3/person/${id}/combined_credits?api_key=${TMDB}&language=tr`);
let d=await r.json();
render(d.cast);
closeDetail();
}

function openSources(){sources.classList.add("show");}
function closeSources(){sources.classList.remove("show");}

function play(src){
let url=`https://vidsrc.me/embed/movie?tmdb=${current}`;
frame.src=url;
player.classList.add("show");

history.unshift({id:current,type:currentType,completed:false});
localStorage.setItem("history",JSON.stringify(history.slice(0,20)));
}

function closePlayer(){
player.classList.remove("show");
frame.src="";
if(history[0]) history[0].completed=true;
localStorage.setItem("history",JSON.stringify(history));
}

function restart(){openSources();}
function closeDetail(){detail.classList.remove("show");}

function clearHistory(){
if(confirm("Ge√ßmi≈ü silinsin mi?")){
history=[];
localStorage.removeItem("history");
}
}

function openPin(){pin.classList.add("show");}
function closePin(){pin.classList.remove("show");}
function checkPin(){
if(pinInput.value===PIN){
window.open("https://www.erogarga.com","_blank");
closePin();
}else alert("Hatalƒ± PIN");
}
</script>
</body>
</html>