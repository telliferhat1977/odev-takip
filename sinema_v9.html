<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SinemaTV Pro v9 - Ultra Source</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --n-red: #E50914; --n-black: #141414; }
        body { background-color: var(--n-black); color: white; font-family: sans-serif; margin: 0; overflow-x: hidden; }
        .nav-item { transition: all 0.2s; cursor: pointer; }
        .nav-item:focus { border: 2px solid white; transform: scale(1.02); outline: none; }
        
        .full-modal { 
            display: none !important; 
            position: fixed; inset: 0; background: var(--n-black); z-index: 1000; 
            overflow-y: auto; padding: 20px; 
        }
        .show-modal { display: flex !important; align-items: center; justify-content: center; background: rgba(0,0,0,0.95); }
        .show-block { display: block !important; }
        
        .video-layer { display: none; position: fixed; inset: 0; background: black; z-index: 2000; flex-direction: column; }
        .badge { font-size: 8px; font-weight: 900; padding: 2px 6px; border-radius: 4px; margin-top: 4px; display: inline-block; }
        
        select {
            background: #222;
            color: white;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #444;
            width: 100%;
            font-weight: bold;
            appearance: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="p-4 md:p-10">

    <div id="mainUI">
        <header class="flex flex-col md:flex-row items-center justify-between mb-10 gap-4">
            <h1 class="text-4xl font-black text-[#E50914] tracking-tighter uppercase italic">Sinema<span class="text-white">TV</span></h1>
            <div class="flex w-full md:w-auto gap-2">
                <input type="text" id="searchInput" placeholder="Film, Dizi veya Oyuncu..." class="bg-[#222] p-4 flex-1 md:w-80 rounded-xl outline-none focus:bg-[#333] border border-transparent focus:border-red-600 transition-all">
                <button onclick="searchContent()" class="bg-[#E50914] px-8 py-4 rounded-xl font-bold uppercase text-sm hover:bg-red-700 transition-colors">Ara</button>
            </div>
        </header>
        <div id="results" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-6"></div>
    </div>

    <div id="detailPage" class="full-modal md:p-20">
        <button onclick="closeDetail()" class="nav-item mb-8 bg-white/10 px-8 py-3 rounded-full font-bold uppercase text-xs">← GERİ DÖN</button>
        <div class="flex flex-col md:flex-row gap-12">
            <img id="detailPoster" class="w-full md:w-80 rounded-3xl shadow-2xl border border-white/5 object-cover">
            <div class="flex-1">
                <h2 id="detailTitle" class="text-4xl md:text-6xl font-black mb-6"></h2>
                <div class="flex gap-4 mb-6 text-lg">
                    <span id="detailRating" class="text-yellow-500 font-bold"></span>
                    <span id="detailYear" class="text-gray-400 font-medium"></span>
                </div>
                <p id="detailOverview" class="text-gray-400 text-lg leading-relaxed mb-10 max-w-2xl"></p>
                <h3 class="text-red-600 font-bold mb-4 uppercase text-[10px] tracking-widest">Oyuncular</h3>
                <div id="detailCast" class="flex flex-wrap gap-2 mb-10"></div>
                <button onclick="checkTypeAndPlay()" class="bg-[#E50914] px-16 py-5 rounded-2xl font-black text-xl shadow-lg hover:scale-105 active:scale-95 transition-all">▶ ŞİMDİ İZLE</button>
            </div>
        </div>
    </div>

    <div id="episodeModal" class="full-modal">
        <div class="bg-[#181818] w-full max-w-xl p-8 rounded-3xl border border-gray-800 shadow-2xl">
            <h2 id="modalTitle" class="text-2xl font-black mb-6 text-red-500 text-center">BÖLÜM SEÇ</h2>
            <div id="episodeList" class="max-h-[50vh] overflow-y-auto pr-2 space-y-2"></div>
            <button onclick="hideModal('episodeModal')" class="mt-6 w-full p-4 bg-gray-800 rounded-xl font-bold uppercase text-xs">Vazgeç</button>
        </div>
    </div>

    <div id="sourceModal" class="full-modal">
        <div class="bg-[#1a1a1a] p-10 rounded-3xl border border-gray-700 w-full max-w-md text-center shadow-2xl">
            <h2 class="text-2xl font-black mb-2 text-white uppercase italic">KAYNAK SEÇİN</h2>
            <p class="text-gray-500 text-xs mb-8">Video açılmazsa listeden başka bir kaynak deneyin.</p>
            
            <div class="relative mb-8 text-left">
                <label class="text-[10px] text-red-600 font-bold uppercase ml-2 mb-1 block">Yayın Sunucusu</label>
                <select id="sourceSelect">
                    <optgroup label="HIZLI KAYNAKLAR (ÖNERİLEN)">
                        <option value="vidlink">VidLink.pro (En İyi)</option>
                        <option value="vidsrc_to">VidSrc.to</option>
                        <option value="vidsrc_me">VidSrc.me</option>
                        <option value="vidsrc_cc">VidSrc.cc</option>
                    </optgroup>
                    <optgroup label="DİĞER KAYNAKLAR">
                        <option value="multiembed_mov">MultiEmbed.mov</option>
                        <option value="multiembed_tv">MultiEmbed.tv</option>
                        <option value="superembed">SuperEmbed.stream</option>
                        <option value="embed_su">Embed.su</option>
                        <option value="moviesapi">MoviesAPI.club</option>
                        <option value="smashystream">SmashyStream</option>
                    </optgroup>
                    <optgroup label="DOĞRUDAN HOSTING">
                        <option value="voe">Voe.sx</option>
                        <option value="doodstream">DoodStream</option>
                        <option value="streamtape">StreamTape</option>
                        <option value="mixdrop">MixDrop</option>
                        <option value="filemoon">Filemoon</option>
                        <option value="streamwish">StreamWish</option>
                        <option value="upstream">Upstream</option>
                        <option value="okru">OK.RU (Hızlı)</option>
                    </optgroup>
                </select>
            </div>

            <button onclick="runFinalPlay()" class="w-full bg-white text-black p-5 rounded-2xl font-black text-lg hover:bg-red-600 hover:text-white transition-all">VİDEOYU BAŞLAT</button>
            <button onclick="hideModal('sourceModal')" class="mt-6 text-gray-500 underline text-xs font-bold block mx-auto">← Vazgeç</button>
        </div>
    </div>

    <div id="videoLayer" class="video-layer">
        <div class="p-4 bg-black flex justify-between items-center border-b border-white/5">
            <button onclick="closePlayer()" class="bg-white/10 px-6 py-2 rounded-full font-bold">← KAYNAK LİSTESİ</button>
            <button onclick="makeFullScreen()" class="bg-red-600 px-6 py-2 rounded-full font-bold uppercase text-[10px]">Tam Ekran</button>
        </div>
        <iframe id="playerFrame" src="" class="flex-1 w-full border-none" allowfullscreen allow="autoplay"></iframe>
    </div>

    <script>
        const API_KEY = "847629da5649502fa6655f73b15a5c8e";
        let currentId, currentType, currentS, currentE;

        window.onload = () => { hideModal('detailPage'); hideModal('sourceModal'); hideModal('episodeModal'); };

        function showModal(id, mode = 'show-modal') { document.getElementById(id).classList.add(mode); }
        function hideModal(id) { document.getElementById(id).classList.remove('show-modal', 'show-block'); }

        async function searchContent() {
            const q = document.getElementById('searchInput').value;
            if(!q) return;
            const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(q)}&language=tr-TR`);
            const data = await res.json();
            if(data.results[0] && data.results[0].media_type === 'person') loadActorWorks(data.results[0].id, data.results[0].name);
            else displayItems(data.results);
            closeDetail();
        }

        function displayItems(items) {
            const container = document.getElementById('results');
            container.innerHTML = "";
            items.forEach(item => {
                if(!item.poster_path && !item.profile_path) return;
                const type = item.media_type || (item.first_air_date ? 'tv' : 'movie');
                const btn = document.createElement('button');
                btn.className = "nav-item rounded-2xl overflow-hidden bg-[#1a1a1a] shadow-lg text-left focus:ring-2 focus:ring-red-600";
                const img = item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : `https://image.tmdb.org/t/p/w500${item.profile_path}`;
                const label = type === 'movie' ? 'FİLM' : (type === 'tv' ? 'DİZİ' : 'OYUNCU');
                const color = type === 'movie' ? 'bg-blue-600/20 text-blue-400' : 'bg-red-600/20 text-red-400';
                btn.innerHTML = `<img src="${img}" class="w-full aspect-[2/3] object-cover pointer-events-none"><div class="p-3"><div class="text-[10px] font-bold truncate">${item.title || item.name}</div><span class="badge ${color}">${label}</span></div>`;
                btn.onclick = () => (item.media_type === 'person' || type === 'person') ? loadActorWorks(item.id, item.name) : openDetails(item.id, type);
                container.appendChild(btn);
            });
        }

        async function loadActorWorks(id, name) {
            closeDetail();
            document.getElementById('results').innerHTML = "<div class='col-span-full text-center p-20 font-bold text-red-500 animate-pulse uppercase'>Yükleniyor...</div>";
            const res = await fetch(`https://api.themoviedb.org/3/person/${id}/combined_credits?api_key=${API_KEY}&language=tr-TR`);
            const data = await res.json();
            displayItems(data.cast.sort((a,b) => b.vote_count - a.vote_count));
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        async function openDetails(id, type) {
            currentId = id; currentType = type;
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=tr-TR&append_to_response=credits`);
            const data = await res.json();
            document.getElementById('detailTitle').innerText = data.title || data.name;
            document.getElementById('detailOverview').innerText = data.overview || "Açıklama mevcut değil.";
            document.getElementById('detailRating').innerText = "⭐ " + (data.vote_average ? data.vote_average.toFixed(1) : "0.0");
            document.getElementById('detailYear').innerText = (data.release_date || data.first_air_date || "").split('-')[0];
            document.getElementById('detailPoster').src = `https://image.tmdb.org/t/p/w500${data.poster_path}`;
            const cast = document.getElementById('detailCast'); cast.innerHTML = "";
            data.credits.cast.slice(0, 8).forEach(a => {
                const b = document.createElement('button'); b.className = "bg-[#222] px-3 py-1 rounded-full text-[10px] font-bold hover:bg-red-600";
                b.innerText = a.name; b.onclick = (e) => { e.stopPropagation(); loadActorWorks(a.id, a.name); };
                cast.appendChild(b);
            });
            showModal('detailPage', 'show-block'); window.scrollTo({top: 0, behavior: 'smooth'});
        }

        async function checkTypeAndPlay() {
            if(currentType === 'tv') {
                const res = await fetch(`https://api.themoviedb.org/3/tv/${currentId}?api_key=${API_KEY}&language=tr-TR`);
                const data = await res.json();
                const list = document.getElementById('episodeList'); list.innerHTML = "";
                data.seasons.forEach(s => {
                    if(s.season_number === 0 || s.episode_count === 0) return;
                    const b = document.createElement('button'); b.className = "w-full text-left p-4 bg-[#222] rounded-xl font-bold flex justify-between";
                    b.innerHTML = `<span>${s.name}</span> <span class="text-red-600 text-[10px] uppercase">${s.episode_count} Bölüm</span>`;
                    b.onclick = async () => {
                        currentS = s.season_number;
                        const epRes = await fetch(`https://api.themoviedb.org/3/tv/${currentId}/season/${s.season_number}?api_key=${API_KEY}&language=tr-TR`);
                        const epData = await epRes.json();
                        list.innerHTML = "";
                        epData.episodes.forEach(ep => {
                            const eb = document.createElement('button'); eb.className = "w-full text-left p-4 bg-[#262626] rounded-xl text-xs";
                            eb.innerText = `${ep.episode_number}. ${ep.name}`;
                            eb.onclick = () => { currentE = ep.episode_number; hideModal('episodeModal'); showModal('sourceModal'); };
                            list.appendChild(eb);
                        });
                    };
                    list.appendChild(b);
                });
                showModal('episodeModal');
            } else { showModal('sourceModal'); }
        }

        function runFinalPlay() {
            const provider = document.getElementById('sourceSelect').value;
            const isTV = currentType === 'tv';
            const base = {
                vidlink: isTV ? `https://vidlink.pro/tv/${currentId}/${currentS}/${currentE}` : `https://vidlink.pro/movie/${currentId}`,
                vidsrc_to: isTV ? `https://vidsrc.to/embed/tv/${currentId}/${currentS}/${currentE}` : `https://vidsrc.to/embed/movie/${currentId}`,
                vidsrc_me: isTV ? `https://vidsrc.me/embed/tv?tmdb=${currentId}&sea=${currentS}&epi=${currentE}` : `https://vidsrc.me/embed/movie?tmdb=${currentId}`,
                vidsrc_cc: isTV ? `https://vidsrc.cc/v2/embed/tv/${currentId}/${currentS}/${currentE}` : `https://vidsrc.cc/v2/embed/movie/${currentId}`,
                multiembed_mov: isTV ? `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1&s=${currentS}&e=${currentE}` : `https://multiembed.mov/directstream.php?video_id=${currentId}&tmdb=1`,
                multiembed_tv: isTV ? `https://multiembed.tv/directstream.php?video_id=${currentId}&tmdb=1&s=${currentS}&e=${currentE}` : `https://multiembed.tv/directstream.php?video_id=${currentId}&tmdb=1`,
                superembed: isTV ? `https://superembed.stream/tv/${currentId}/${currentS}/${currentE}` : `https://superembed.stream/movie/${currentId}`,
                embed_su: isTV ? `https://embed.su/embed/tv/${currentId}/${currentS}/${currentE}` : `https://embed.su/embed/movie/${currentId}`,
                moviesapi: isTV ? `https://moviesapi.club/tv/${currentId}-${currentS}-${currentE}` : `https://moviesapi.club/movie/${currentId}`,
                smashystream: isTV ? `https://embed.smashystream.com/playere.php?tmdb=${currentId}&season=${currentS}&episode=${currentE}` : `https://embed.smashystream.com/playere.php?tmdb=${currentId}`,
                voe: isTV ? `https://voe.sx/embed/tv/${currentId}/${currentS}/${currentE}` : `https://voe.sx/embed/movie/${currentId}`,
                doodstream: isTV ? `https://doodstream.com/e/tv/${currentId}/${currentS}/${currentE}` : `https://doodstream.com/e/movie/${currentId}`,
                streamtape: isTV ? `https://streamtape.com/e/tv/${currentId}/${currentS}/${currentE}` : `https://streamtape.com/e/movie/${currentId}`,
                mixdrop: isTV ? `https://mixdrop.co/e/tv/${currentId}/${currentS}/${currentE}` : `https://mixdrop.co/e/movie/${currentId}`,
                filemoon: isTV ? `https://filemoon.sx/e/tv/${currentId}/${currentS}/${currentE}` : `https://filemoon.sx/e/movie/${currentId}`,
                streamwish: isTV ? `https://streamwish.to/e/tv/${currentId}/${currentS}/${currentE}` : `https://streamwish.to/e/movie/${currentId}`,
                upstream: isTV ? `https://upstream.to/e/tv/${currentId}/${currentS}/${currentE}` : `https://upstream.to/e/movie/${currentId}`,
                okru: isTV ? `https://ok.ru/videoembed/tv/${currentId}/${currentS}/${currentE}` : `https://ok.ru/videoembed/${currentId}`
            };
            document.getElementById('playerFrame').src = base[provider];
            document.getElementById('videoLayer').style.display = 'flex';
            hideModal('sourceModal');
        }

        function closePlayer() { document.getElementById('playerFrame').src = ""; document.getElementById('videoLayer').style.display = 'none'; showModal('sourceModal'); }
        function closeDetail() { hideModal('detailPage'); hideModal('sourceModal'); hideModal('episodeModal'); }
        function makeFullScreen() { const f = document.getElementById('playerFrame'); if(f.requestFullscreen) f.requestFullscreen(); else if(f.webkitRequestFullscreen) f.webkitRequestFullscreen(); }
        document.getElementById("searchInput").addEventListener("keypress", (e) => { if (e.key === "Enter") searchContent(); });
    </script>
</body>
</html>
